#!/usr/bin/env bash
#
# vim:ft=sh:fenc=UTF-8:ts=4:sts=4:sw=4:expandtab:foldmethod=marker:foldlevel=0:
#
# $Id: pacdiff 783 2008-03-24 12:20:18Z wael $

diffprog=${DIFFPROG:-vimdiff}
for x in $(find /etc/ -name *.pacnew -o -name *.pacorig -o -name *.pacsave)
do
    echo "File: ${x%.pac*}"
    chk="$(cmp $x ${x%.pac*})"
    if [ -z "${chk}" ]; then
        echo "  Files are identical, removing..."
        rm $x
    else
        echo -n "  File differences found. (V)iew, (S)kip, (R)emove: [v/s/r] "
        read c
        c="$(echo $c| tr A-Z a-z)" #tolower
        if [ "$c" = "r" ]; then
            rm $x
        elif [ "$c" = "s" ]; then
            continue
        else
            [ "$c" = "n" -o "$c" = "N" ] || $diffprog $x ${x%.pac*}
            echo -n "  Remove file? [Y/n] "
            read c
            [ "$c" = "n" -o "$c" = "N" ] || rm $x
        fi
    fi
done
